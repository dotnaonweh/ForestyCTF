# figl33t
> My friend really likes ascii art. So I created this website for her.
> 
> http://103.167.136.89:10056/
> 
> Author: bleedz#0666 (Discord) / @bl33dz (Tele)

## About the Challenge
Diberikan sebuah website dengan tampilan 
<img width="920" alt="image" src="https://github.com/dotnaonweh/ForestyCTF/assets/49785290/75e6b76d-e554-4865-868e-14e87dc3cc4d">


Dan juga diberikan code

```const express = require('express');
const bodyParser = require('body-parser');
const exec = require('child_process').exec;
const app = express();

app.use(express.static('public'));
app.use(bodyParser.json());

app.get('/', (req, res) => {
    res.sendFile(`${__dirname}/public/index.html`);
    }
);

app.post('/figlet', (req, res) => {
    let cmd = 'timeout 1 figlet \'' + req.body.text + '\'';
    exec(cmd, (err, stdout, stderr) => {
        if (err) {
            console.log(stderr);
            res.send('Error');
        } else {
            res.send(stdout);
        }
    });
});

app.listen(3000, () => {
    console.log('figl33t listening on port 3000!');
});
```
    

## How to Solve?
Jika kita lihat pada code yang diberikan, kita bisa lihat pada endpoint /figlet terdapat Vulnerability Command Injection.

Coba test dengan payload 
> ';ls'

<img width="600" alt="image" src="https://github.com/dotnaonweh/ForestyCTF/assets/49785290/344769ef-6746-4e0e-a060-bea90aa9b485">

Dan benar saja, disitu muncul list file dan direktori, akan tetapi flag nya tidak ada di direktori tersebut, kita coba cek di direktori / dengan payload 
> ';ls /'

<img width="456" alt="image" src="https://github.com/dotnaonweh/ForestyCTF/assets/49785290/596d9e5b-93a7-4556-8117-7989707fe6f0">


terdapat file flag-3eb436c4-1dd2-4e01-b1f9-af7c2af01481.txt, langsung saja kita cek dengan payload
> ';cat ../flag-3eb436c4-1dd2-4e01-b1f9-af7c2af01481.txt'

didapatkan flag nya yaitu  : ForestyHC{w0w_u_can_hack_figl33t_7d7c1b}
